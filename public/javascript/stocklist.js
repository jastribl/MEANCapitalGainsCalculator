// Generated by CoffeeScript 1.9.3
(function() {
  var stockListApp;

  stockListApp = angular.module('stockListApp', []);

  stockListApp.controller('StockListController', function($scope, $http) {
    var resetError, resetForm, resetNewStock, updateStockList;
    updateStockList = function() {
      return $http.get('/api/stockList').then(function(stockList) {
        return $scope.stockList = stockList.data;
      });
    };
    resetNewStock = function() {
      return $scope.newStock = {};
    };
    resetError = function() {
      return $scope.error = null;
    };
    resetForm = function() {
      updateStockList();
      resetNewStock();
      return resetError();
    };
    $scope.remove = function(stockName) {
      return $http["delete"]('/api/stockList?stockName=' + stockName).then(function() {
        updateStockList();
        return $scope.validate();
      });
    };
    $scope.add = function() {
      return $http.post('/api/stockList?stock=' + JSON.stringify($scope.newStock)).then(function() {
        return resetForm();
      });
    };
    $scope.validate = function() {
      if ($scope.newStock.stockName) {
        $http.get('/api/stockList/stockExists?stock=' + JSON.stringify($scope.newStock)).then(function(res) {
          if (res.data.stockExists) {
            return $scope.error = res.data.error;
          }
        });
      }
      return resetError();
    };
    return resetForm();
  });

}).call(this);
